<h1>Listing weights</h1>

<div id="weights_chart">
</div>

<table>
  <tbody>
    <tr>
      <td>Last data point received: </td>
      <td><%= @weight_data_info.last_received_raw %></td>
      <td><%= @weight_data_info.last_received_created_at %></td>
    </tr>
    <tr>
      <td>Last data point stored: </td>
      <td><%= @weight_data_info.last_stored_raw %></td>
      <td><%= @weight_data_info.last_stored_created_at %></td>
    </tr>
    <tr>
      <td>The time is now: </td>
      <td></td>
      <td><%= Time.now %></td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Pints</th>
      <th>Raw</th>
      <th>Timestamp</th>
      <th></th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @weights_last.each do |weight| %>
      <tr>
        <td><%= weight.get_beer_count %></td>
        <td><%= weight.raw %></td>
        <td><%= weight.created_at %></td>
        <td><%= link_to 'Show', weight %></td>
        <td><%= link_to 'Edit', edit_weight_path(weight) %></td>
        <td><%= link_to 'Destroy', weight, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<script>
  // chart data is for highcharts. data now in pints
  var chart_data = [<%= @weights.map { |w| "["+w.created_at.to_i.to_s+"000,"+w.get_beer_count.to_s+"]" }.join(',') %>,[<%= Time.now.to_i.to_s %>,<%= @weight_data_info.last_stored_raw.to_s %>]]
</script>

<br>

<%= link_to 'New Weight', new_weight_path, class: "button" %>
